import"../chunks/DsnmJJEf.js";import{m as G,o as as,x as O,h as N,z as rs,J as ts,W as F,aF as is,aG as ns,a7 as os,ad as k,w as q,y as H,C as ls,ap as ds,F as L,I as us,A as fs,a6 as cs,aH as hs,a4 as J,an as K,at as vs,aI as _s,B as P,E as ms,aJ as ys,aK as ps,aL as S,D as U,v as xs,aM as gs,am as ws,aN as Es,f as Ms,_ as W,aO as Is,T as Q,l as Z,k as X,$ as V,a1 as Ts}from"../chunks/C5ZR72HS.js";import{d as bs}from"../chunks/DEXKwgUk.js";import{s as As}from"../chunks/RnJuPDcB.js";import{b as Ns}from"../chunks/Ed9NBBXF.js";function Cs(o,e){return e}function Ds(o,e,s){for(var r=o.items,n=[],t=e.length,a=0;a<t;a++)gs(e[a].e,n,!0);var i=t>0&&n.length===0&&s!==null;if(i){var p=s.parentNode;ws(p),p.append(s),r.clear(),M(o,e[0].prev,e[t-1].next)}Es(n,()=>{for(var c=0;c<t;c++){var _=e[c];i||(r.delete(_.k),M(o,_.prev,_.next)),U(_.e,!i)}})}function Rs(o,e,s,r,n,t=null){var a=o,i={flags:e,items:new Map,first:null};{var p=o;a=N?O(rs(p)):p.appendChild(G())}N&&ts();var c=null,_=!1,I=new Map,l=is(()=>{var f=s();return vs(f)?f:f==null?[]:K(f)}),m,d;function u(){Hs(d,m,i,I,a,n,e,r,s),t!==null&&(m.length===0?c?P(c):c=L(()=>t(a)):c!==null&&ms(c,()=>{c=null}))}as(()=>{d??=Ms,m=F(l);var f=m.length;if(_&&f===0)return;_=f===0;let b=!1;if(N){var w=ns(a)===os;w!==(f===0)&&(a=k(),O(a),q(!1),b=!0)}if(N){for(var h=null,x,v=0;v<f;v++){if(H.nodeType===ls&&H.data===ds){a=H,b=!0,q(!1);break}var T=m[v],E=r(T,v);x=Y(H,i,h,null,T,E,v,n,e,s),i.items.set(E,x),h=x}f>0&&O(k())}if(N)f===0&&t&&(c=L(()=>t(a)));else if(us()){var A=new Set,g=fs;for(v=0;v<f;v+=1){T=m[v],E=r(T,v);var C=i.items.get(E)??I.get(E);C?j(C,T,v):(x=Y(null,i,null,null,T,E,v,n,e,s,!0),I.set(E,x)),A.add(E)}for(const[D,R]of i.items)A.has(D)||g.skipped_effects.add(R.e);g.oncommit(u)}else u();b&&q(!0),F(l)}),N&&(a=H)}function Hs(o,e,s,r,n,t,a,i,p){var c=e.length,_=s.items,I=s.first,l=I,m,d=null,u=[],f=[],b,w,h,x;for(x=0;x<c;x+=1){if(b=e[x],w=i(b,x),h=_.get(w),h===void 0){var v=r.get(w);if(v!==void 0){r.delete(w),_.set(w,v);var T=d?d.next:l;M(s,d,v),M(s,v,T),z(v,T,n),d=v}else{var E=l?l.e.nodes_start:n;d=Y(E,s,d,d===null?s.first:d.next,b,w,x,t,a,p)}_.set(w,d),u=[],f=[],l=d.next;continue}if(j(h,b,x),(h.e.f&S)!==0&&P(h.e),h!==l){if(m!==void 0&&m.has(h)){if(u.length<f.length){var A=f[0],g;d=A.prev;var C=u[0],D=u[u.length-1];for(g=0;g<u.length;g+=1)z(u[g],A,n);for(g=0;g<f.length;g+=1)m.delete(f[g]);M(s,C.prev,D.next),M(s,d,C),M(s,D,A),l=A,d=D,x-=1,u=[],f=[]}else m.delete(h),z(h,l,n),M(s,h.prev,h.next),M(s,h,d===null?s.first:d.next),M(s,d,h),d=h;continue}for(u=[],f=[];l!==null&&l.k!==w;)(l.e.f&S)===0&&(m??=new Set).add(l),f.push(l),l=l.next;if(l===null)continue;h=l}u.push(h),d=h,l=h.next}if(l!==null||m!==void 0){for(var R=m===void 0?[]:K(m);l!==null;)(l.e.f&S)===0&&R.push(l),l=l.next;var $=R.length;if($>0){var ss=c===0?n:null;Ds(s,R,ss)}}o.first=s.first&&s.first.e,o.last=d&&d.e;for(var es of r.values())U(es.e);r.clear()}function j(o,e,s,r){cs(o.v,e),o.i=s}function Y(o,e,s,r,n,t,a,i,p,c,_){var I=(p&ys)!==0,l=(p&ps)===0,m=I?l?hs(n,!1,!1):J(n):n,d=(p&_s)===0?a:J(a),u={i:d,v:m,k:t,a:null,e:null,prev:s,next:r};try{if(o===null){var f=document.createDocumentFragment();f.append(o=G())}return u.e=L(()=>i(o,m,d,c),N),u.e.prev=s&&s.e,u.e.next=r&&r.e,s===null?_||(e.first=u):(s.next=u,s.e.next=u.e),r!==null&&(r.prev=u,r.e.prev=u.e),u}finally{}}function z(o,e,s){for(var r=o.next?o.next.e.nodes_start:s,n=e?e.e.nodes_start:s,t=o.e.nodes_start;t!==null&&t!==r;){var a=xs(t);n.before(t),t=a}}function M(o,e,s){e===null?o.first=s:(e.next=s,e.e.next=s&&s.e),s!==null&&(s.prev=e,s.e.prev=e&&e.e)}var Bs=Z('<div class="ball svelte-q1ynn0" role="none"></div>'),Os=Z('<div class="background svelte-q1ynn0" role="none"></div>');function qs(o,e){W(e,!0);const s=e.balls.length,r=Is([]);let n=0;for(let a=0;a<s;a++)r.push(void 0);Q(()=>{for(let i=0;i<s;i++)r[i].style.width=e.balls[i].radius*2+"px",r[i].style.height=e.balls[i].radius*2+"px";const a=setInterval(()=>{for(let i=0;i<s;i++)r[i].style.left=e.balls[i].coords.x-e.balls[i].radius+"px",r[i].style.top=e.balls[i].coords.y-e.balls[i].radius+"px"},10);return()=>{clearInterval(a)}});var t=Os();t.__mousemove=a=>{let i=e.balls[n];i.drag&&(i.coords.x=a.clientX,i.coords.y=a.clientY)},t.__mouseup=()=>{let a=e.balls[n];a.drag&&(a.drag=!1,a.last_coords.x=a.coords.x,a.last_coords.y=a.coords.y)},Rs(t,21,()=>e.balls,Cs,(a,i,p)=>{var c=Bs();As(c,"name",p),c.__mousedown=_=>{F(i).drag=!0,n=p},Ns(c,(_,I)=>r[I]=_,_=>r?.[_],()=>[p]),X(a,c)}),Ts(t),X(o,t),V()}bs(["mousemove","mouseup","mousedown"]);class y{constructor(e,s){this.x=e,this.y=s}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const e=this.magnitude();e>0&&(this.x=this.x/e,this.y=this.y/e)}static add(e,s){return new y(e.x+s.x,e.y+s.y)}static sub(e,s){return new y(e.x-s.x,e.y-s.y)}static mul(e,s){return new y(e.x*s.x,e.y*s.y)}static scalar_mul(e,s){return new y(e.x*s,e.y*s)}}class B{constructor(e,s,r){this.radius=r,this.coords=new y(e,s),this.last_coords=new y(e,s),this.acceleration=new y(0,3699.792541346783*9.81),this.mass=4/3*Math.PI*Math.pow(this.radius*.00027028542514872584,3)*1e3,this.drag=!1}update_coords(e){if(!this.drag){const s=y.sub(this.coords,this.last_coords);this.last_coords=this.coords,this.coords=y.add(y.add(this.coords,s),y.scalar_mul(this.acceleration,e*e))}}apply_constraints(e,s){this.coords.y-this.radius<0?this.coords.y=0+this.radius:this.coords.y+this.radius>s&&(this.coords.y=s-this.radius),this.coords.x-this.radius<0?this.coords.x=0+this.radius:this.coords.x+this.radius>e&&(this.coords.x=e-this.radius)}static checks_collision(e,s){const r=e.coords.x-s.coords.x,n=e.coords.y-s.coords.y,t=r*r+n*n,a=(e.radius+s.radius)*(e.radius+s.radius);return t<=a}static responds_collision(e,s){let r=y.sub(e.coords,s.coords);const n=r.magnitude(),t=e.radius+s.radius-n;t>0&&(r.normalize(),e.coords=y.add(e.coords,y.scalar_mul(r,t*(s.mass/(e.mass+s.mass)))),s.coords=y.sub(s.coords,y.scalar_mul(r,t*(e.mass/(e.mass+s.mass)))))}}function ks(o,e){W(e,!0);const s=[],r=500;for(let n=0;n<r-2;n++)s.push(new B(Math.random()*1920,Math.random()*1080,20));s.push(new B(Math.random()*1920,Math.random()*1080,50)),s.push(new B(Math.random()*1920,Math.random()*1080,100)),Q(()=>{const n=setInterval(()=>{for(let t=0;t<r-1;t++)for(let a=t+1;a<r;a++)B.checks_collision(s[t],s[a])&&B.responds_collision(s[t],s[a]);for(let t of s)t.update_coords(.001),t.apply_constraints(window.innerWidth,window.innerHeight)},1);return()=>{clearInterval(n)}}),qs(o,{get balls(){return s}}),V()}export{ks as component};
